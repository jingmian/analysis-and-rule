# 编码规范：

## 一、文件排版

### 1.包含头文件

* 先系统头文件，后用户头文件
* 系统头文件应用`#include <xxx.h>`
* 自定义文件应用`#include "xxx.h"`
* 只引用需要的头文件

### 2.h和cpp文件

* 头文件命名为xxx.h，C++文件命名为xxx.cpp
* 文件名用大小写混合，必须有意义且为单词如：Reader.h，FileManagement.h
* 头文件除了特殊情况，应使用`#ifdef`控制块
* 头文件，首先是包含代码块，其次是宏定义代码块，然后是全局变量，全局常量，类型定义，类定义，内联部分
* cpp文件，包含指令，宏定义，全局变量，函数定义

### 3.文件结构

* 文件应包含文件头注释
* 文件头、控制块，`#include`部分、宏定义部分、`class`部分、全局常量部分、全局变量部分、函数和函数之间，用两个空行

## 二、注释

* 类函数必须写上注释，说明函数的用途，实现方法
* 类变量必须写上注释，说明变量的用途
* 善未实现完整的代码，或者需要进一步优化的代码，应加上 // TODO …
* 调试的代码，加上注释 // only for DEBUG
* 需要引起关注的代码，加上注释 // NOTE …

## 三、命名规则

* 同一性：在编写一个子模块或派生类的时候，要遵循其基类或整体模块的命名风格，保持命名风格在整个模块中的同一性
* 标识符组成：标识符采用英文单词或其组合，应当直观且可以拼读，可望文知意，用词应当准确，避免用拼音命名
* 最小化长度 && 最大化信息量原则：在保持一个标识符意思明确的同时，应当尽量缩短其长度
* 避免过于相似：不要出现仅靠大小写区分的相似的标识符，例如`"i"与"I"`，`"function"`与`"Function"`等等
* 避免在不同级别的作用域中重名：程序中不要出现名字完全相同的局部变量和全局变量，尽管两者的作用域不同而不会发生语法错误，但容易使人误解
* 避免名字中出现数字编号：尽量避免名字中出现数字编号，如Value1,Value2等，除非逻辑上的确需要编号。
* 正确命名具有互斥意义的标识符：用正确的反义词组命名具有互斥意义的标识符，如：`"nMinValue"` 和`"nMaxValue"`，`"GetName()"` 和`"SetName()"` ….

## 四、代码风格

* 在代码行的结尾部分不能出现多余的空格
* 不要在`"::","->","."`前后加空格
* 不要在`"，","；"`之前加空格
* 类，结构，枚举，联合：大括号另起一行
* 函数体的{需要新起一行，在{之前不能有缩进
* 除了特别情况，函数体内不能宏定义指令
* `"if"、"for"、"while"、"do"、"try"、"catch"` 等语句自占一行，执行语句不得紧跟其后。不论执行语句有多少都要加“{ }” 。这样可以防止书写和修改代码时出现失误
* `"if"、"for"、"while"、"do"、"try"、"catch"` 的括号和表达式，括号可紧挨关键字，这样强调的是表达式
*  if语句如果有else语句，用 `} else {` 编写为一行
* 一行代码只做一件事情，如只定义一个变量，或只写一条语句。这样的代码容易阅读，并且方便于写注释
* 多行变量定义，为了追求代码排版美观，可将变量竖向对齐
* 代码行最大长度宜控制在一定个字符以内，能在当前屏幕内全部可见为宜
*  case关键字应和switch对齐
* 空循环使用  `while( 1 )`
* 重载基类虚函数，应在该组虚函数前写注释 // implement XXX
* 不许使用`goto`

## 五、类型

* 定义指针和引用时*和&紧跟类型
* 尽量避免使用浮点数，除非必须
* 用`typedef`简化程序中的复杂语法
* 避免定义无名称的类型。例如：`typedef enum { EIdle, EActive } TState;`
* 不使用union
* 用`enum`取代(一组相关的)常量
* 尽量用引用取代指针
* 定义变量完成后立即初始化
* 除非必要，否则不使用强制类型转换

## 六、表达式

* 在表达式中不可使用赋值语句
* 避免对浮点类型做等于或不等于判断
* 在循环过程中不要修改循环计数器
* 检测空指针，用 `if( p )`
* 检测非空指针，用 `if( !p )`

## 七、函数

* 构造接口的基类的虚函数应为纯虚函数
* 努力使类的接口少而完备
* 尽量使用常成员函数代替非常成员函数，`const`函数
* 尽量不要重新定义(继承来的)非虚函数，除非考虑完备了基类属性的初始化问题
* 申请内存用new操作符，释放内存用delete操作符，`new`和`delete`，`new[]`和`delete[]`成对使用
* 申请内存完成之后，要检测指针是否申请成功，处理申请失败的情况
* 释放内存完成后将指针赋空，避免出现野指针
* 谁申请谁释放。优先级：函数层面，类层面，模块层面
* 使用指针前进行判断合法性，应考虑到为空的情况的处理
* 使用数组时，应先判断索引的有效性，处理无效的索引的情况
* 使用错误传递的错误处理思想
* 尽量用`++i`代替`i++`，即用前缀代替后缀运算
* 尽量避免在循环体内部定义对象
* 避免对象拷贝，尤其是代价很高的对象拷贝
* 避免生成临时对象，尤其是大的临时对象